# Gymnastics Beam Injury Risk Analysis

## Project Overview
This project analyzes **injury risk during gymnastics beam routines**.  
It uses a **compilation video of beam falls** as input and performs:

- Pose detection using **MediaPipe**  
- Calculation of **joint angles** and **angular velocities**  
- Flagging of **risky frames** based on extreme joint velocities  
- An **illustrative machine learning model** (Random Forest) to predict risky frames  

> **Note:** The dataset is small and the ML model is illustrative — intended for demonstration, not production use.

## Folder Structure
- `beam_video.mp4` — Input video (slightly above 50MB recommendation limit)
- `injury_risk_analysis.ipynb` — Jupyter notebook with all code and analysis  
- `beam_pose_risk_data.csv` — Generated dataset  
- `requirements.txt` — Python dependencies  
- `README.md` — This file
- `frame-vs-angularvel.png` — Plot angular velocity changes over time frame with risk threshold
- `joints-feature-importance.png` — Plot feature importance for each joint based on RandomForest

## Dependencies
Install required packages:
```
pip install -r requirements.txt
```
### Contents of requirements.txt:
- pandas
- numpy
- matplotlib
- scikit-learn
- opencv-python
- mediapipe
- jupyter


---

## Usage 
1. Place your video file in the project folder (or reference an external link).
2. Open and run `injury_risk_analysis.ipynb`.
3. The notebook will:
   - Read video frames
   - Detect pose landmarks
   - Calculate joint angles and angular velocities
   - Cleaning function to flag suspicious values generated by MediaPipe due to error, removing angular velocities higher than 30 degrees/second for a standard YouTube video of ~30FPS
   - Flag frames exceeding velocity thresholds as `risky_velocity`
   - Save the dataset to `beam_pose_risk_data.csv`
   - Plots visualizations with threshold of 75% percentile and angular velocities higher than it designated as risky
   - Train an illustrative Random Forest classifier to predict risky frames

---

## Output

The dataset contains:
- Joint angles: left_knee, right_knee, left_hip, right_hip, left_shoulder, right_shoulder (degrees)
- Angular velocities: *_vel for each joint (degrees/frame)
- Risky frames: risky_velocity (0 or 1) indicating extreme angular velocity

---

## Analysis / Visualization

The notebook includes:
- Histograms of joint angles and velocities
- Time-series plots of angular velocities
- Counts of risky frames and joint contributions
- Machine learning demonstration:
   - Random Forest classifier
   - Feature importance visualization

---
## Discussion and conclusion

### Frame vs. Angular velocity `frame-vs-angularvel.png`
This plot shows the change in angular velocity over the time frame. The joints in frames above the risk threshold which was set at the 75th percentile show variation. There is specific joint exposed to more risk than the other in the beam routines, which indicates all of them have similar probabilities of injury at high risk angular velocities.

This is also reflected on in the frame value counts designated as risky for each joint:

####Risky counts per joint

| Joint    | Risky counts |
|----------|----------|
| left_knee_vel | 339  |
| right_knee_vel | 335 |
| left_hip_vel | 315 |
| right_hip_vel | 318 |
| left_shoulder_vel | 376 |
| right_shoulder_vel |320 |


### Feature importance by joint `joints-feature-importance.png`
This bar plot shows the feature importance of each joint based on RandomForest. This ML model is illustrative and needs a much larger dataset to work with if it is to perform well. However, we see that the right and left shoulder joints have slightly higher feature importance values than the other joints when predicting risk of injury. This can suggest the heavier strain in the shoulders and arms when performing beam routines, but of course, feature importance does not equal better correlation to the risk factor.


## Next Steps / Extensions
- Expand dataset with more videos and gymnasts
- Try other ML models (Logistic Regression, Gradient Boosting, SVM)
- Add video visualization of risky frames
- Explore additional biomechanics features (joint torques, angular acceleration)
